import{c as o,g as t,l as n,r as c,b as x,o as _,a as p,f as r,m as f,t as i,w as h,h as w,j as g}from"./index-CFa-6O-b.js";import{S as k}from"./Spinner-T2hdbTxp.js";function b(d,l){return n(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function P(d,l){return n(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"})])}const C={class:"min-h-screen bg-gray-50 p-4"},j={class:"max-w-md mx-auto bg-white rounded-lg shadow-md p-6"},S={key:0,class:"text-center py-8"},B={key:1,class:"space-y-4"},M={class:"text-center"},V={class:"bg-gray-50 p-4 rounded-lg"},D={class:"space-y-2"},I={class:"flex justify-between"},N={class:"font-medium"},Z={class:"flex justify-between"},$={class:"font-medium"},A={class:"flex justify-between"},L={class:"font-medium"},q={key:2,class:"text-center py-8"},E={class:"mt-2 text-gray-600"},R={__name:"PaymentSuccess",setup(d){const l=x(),u=c(l.query.payment_id),s=c(null),m=c(!0);_(async()=>{try{const a=await p.get(`/api/v1/payments/${u.value}/`,{validateStatus:e=>e<500});if(a.status===404){error.value="Payment record not found";return}s.value=a.data,s.value.gateway==="chapa"&&!s.value.status&&await v()}catch(a){console.error("Payment verification failed:",a),a.value="Payment verification failed"}finally{m.value=!1}});const v=async()=>{try{(await p.post("/api/v1/payments/verify-chapa/",{tx_ref:s.value.chapa_tx_ref})).data.status==="success"&&(s.value.status=!0)}catch(a){console.error("Chapa verification failed:",a)}};return(a,e)=>{const y=w("router-link");return n(),o("div",C,[t("div",j,[m.value?(n(),o("div",S,[r(k,{class:"w-12 h-12 mx-auto text-blue-600"}),e[0]||(e[0]=t("p",{class:"mt-4 text-gray-600"},"Verifying payment...",-1))])):s.value?(n(),o("div",B,[t("div",M,[r(f(b),{class:"w-12 h-12 mx-auto text-green-600"}),e[1]||(e[1]=t("h2",{class:"text-2xl font-bold mt-4"},"Payment Successful! ðŸŽ‰",-1))]),t("div",V,[t("dl",D,[t("div",I,[e[2]||(e[2]=t("dt",{class:"text-gray-600"},"Payment ID:",-1)),t("dd",N,i(s.value.payment_id),1)]),t("div",Z,[e[3]||(e[3]=t("dt",{class:"text-gray-600"},"Amount:",-1)),t("dd",$,"$"+i(s.value.amount),1)]),t("div",A,[e[4]||(e[4]=t("dt",{class:"text-gray-600"},"Course:",-1)),t("dd",L,i(s.value.course.title),1)])])]),r(y,{to:"/my-courses",class:"block w-full text-center bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700"},{default:h(()=>e[5]||(e[5]=[g(" Access Your Course ")])),_:1})])):(n(),o("div",q,[r(f(P),{class:"w-12 h-12 mx-auto text-red-600"}),e[6]||(e[6]=t("h2",{class:"text-xl font-bold mt-4"},"Payment Verification Failed",-1)),t("p",E," Please contact support with reference ID: "+i(u.value),1)]))])])}}};export{R as default};
